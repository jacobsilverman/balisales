"use strict";(self.webpackChunkbalisales=self.webpackChunkbalisales||[]).push([[753],{1648:function(e,t,n){n.d(t,{C:function(){return v}});var i=n(1413),a=n(3433),r=n(9439),l=n(9135),s=n(3675),c=n(2791),o=n(9743),d=n(2677),u=n(6157),h=n(1889),x=n(7621),f=n(9230),p=n(6151),Z=n(4727),m=n(5419),g=(n(9390),n(184)),j=function(e){var t=e.imageLoaded,n=e.setImageLoaded,l=e.imageToCrop,s=e.showCropModal,o=e.setShowCropModal,d=e.setFiles,u=e.setValidation,h=e.setDisplay,x=(0,c.useState)(),f=(0,r.Z)(x,2),j=f[0],v=f[1],b=(0,c.useState)(null),y=(0,r.Z)(b,2),C=y[0],S=y[1],w=(0,c.useState)(null),N=(0,r.Z)(w,2),k=N[0],I=N[1],P=(0,c.useState)(null),T=(0,r.Z)(P,2),L=T[0],R=T[1],B=l?URL.createObjectURL(l):null,F=function(){o(!1),v(),S(),I(),h&&h({display:"block"})};return(0,g.jsxs)(Z.Z,{id:"croppingModal",show:s,onBackdropClick:function(){return F()},children:[(0,g.jsx)("div",{style:{display:"flex",justifyContent:"flex-end",padding:"5px"},children:(0,g.jsx)(p.Z,{onClick:F,color:"error",children:"close"})}),(0,g.jsx)("div",{className:"center",children:"Resizing image to fit the 250px 300px dimensions"}),l&&(0,g.jsx)(m.ZP,{crop:j,onChange:function(e){return v(e)},children:(0,g.jsx)("img",{src:B,onLoad:function(e){if(S(e.currentTarget),l&&!t){var i=e.currentTarget,a=i.width,r=i.height,s=a-250,c=r-300,o=0,d=0;if(c<s){var u=(a-.83*r)/2;a=.83*r,o=u}else if(c>s){var h=(r-(a+.17*a))/2;r=a+.17*a,d=h}v({unit:"px",width:a,height:r,x:o,y:d}),n(!0)}}})}),(0,g.jsx)(p.Z,{variant:"outlined",onClick:function(){return function(){var e=document.createElement("canvas"),t=C.naturalWidth/C.width,n=C.naturalHeight/C.height;e.width=j.width,e.height=j.height;var i=e.getContext("2d"),a=window.devicePixelRatio;e.width=j.width*a,e.height=j.height*a,i.setTransform(a,0,0,a,0,0),i.imageSmoothingQuality="high",i.drawImage(C,j.x*t,j.y*n,j.width*t,j.height*n,0,0,j.width,j.height);var r=e.toDataURL("image/jpeg");I(r),e.toBlob((function(e){R(e);var t=document.getElementById("croppingModal");t.parentElement.scrollTo({left:0,top:t.scrollHeight,behavior:"smooth"})}))}()},children:"Preview"}),k&&(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("div",{className:"center",children:(0,g.jsx)("img",{src:k,style:{height:"300px",width:"250px"}})}),(0,g.jsx)(p.Z,{variant:"contained",color:"success",onClick:function(){F(),d((function(e){return[].concat((0,a.Z)(e),[L])})),u((function(e){return(0,i.Z)((0,i.Z)({},e),{},{picture:!0})}))},children:"Submit"})]})]})},v=function(e){var t=e.files,n=e.setFiles,p=e.validation,Z=e.setValidation,m=e.disableSubmit,v=e.setDisplay,b=(null===t||void 0===t?void 0:t.length)<=1?"200px":"100px",y=(0,f.$G)().t,C=(0,c.useState)(),S=(0,r.Z)(C,2),w=S[0],N=S[1],k=(0,c.useState)(!1),I=(0,r.Z)(k,2),P=I[0],T=I[1],L=(0,g.jsx)(o.Z,{className:"edit-input",children:(0,g.jsx)(d.Z,{xs:12,className:"setting-item",children:(0,g.jsxs)("label",{className:"profile-label center",style:{color:!1===p.picture&&m?"red":"black"},htmlFor:"add-post-image",children:[(0,g.jsx)("input",{id:"add-post-image",className:"profile-input",type:"file",onChange:function(e){v&&v({display:"none"}),N(e.target.files[0]),T(!0),V(!1)},accept:"image/*"}),(0,g.jsx)("span",{children:y("Add Picture")}),(0,g.jsx)("br",{}),(0,g.jsx)(l.H3h,{size:40})]})})}),R=(0,g.jsx)(h.ZP,{justifyContent:"center",container:!0,spacing:3,children:null===t||void 0===t?void 0:t.map((function(e,r){var l="string"!==typeof e?URL.createObjectURL(e):e,c=0===r?"flex-end":r!==t.length-1?"space-between":"flex-start";return(0,g.jsx)(h.ZP,{item:!0,children:(0,g.jsxs)(x.Z,{children:[(0,g.jsx)(u.Z,{variant:"danger",style:{width:"100%",borderRadius:"0px"},onClick:function(){return function(e){var a=null===t||void 0===t?void 0:t.filter((function(t,n){return n!==e}));0===a.length&&Z((function(e){return(0,i.Z)((0,i.Z)({},e),{},{picture:!1})})),n(a)}(r)},children:y("Remove")}),(0,g.jsx)(h.ZP,{item:!0,className:"center",style:{backgroundImage:"url(".concat(l,")"),backgroundSize:"100% 100%",width:b,height:b}},l+"item"),(0,g.jsxs)("div",{style:{display:"flex",justifyContent:c},children:[r>0&&(0,g.jsx)(u.Z,{variant:"outlined",onClick:function(){return function(e){e<=0||n((function(t){var n=(0,a.Z)(t),i=n[e-1];return n[e-1]=n[e],n[e]=i,n}))}(r)},children:s.tq?"^":"<"}),r<t.length-1&&(0,g.jsx)(u.Z,{variant:"outlined",onClick:function(){return function(e){e>=(null===t||void 0===t?void 0:t.length)-1||n((function(t){var n=(0,a.Z)(t),i=n[e+1];return n[e+1]=n[e],n[e]=i,n}))}(r)},children:s.tq?"v":">"})]})]})},l)}))}),B=(0,c.useState)(!1),F=(0,r.Z)(B,2),M=F[0],V=F[1];return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(j,{imageLoaded:M,setImageLoaded:V,imageToCrop:w,showCropModal:P,setShowCropModal:T,setValidation:Z,setFiles:n,setDisplay:v}),L,R]})}},1822:function(e,t,n){n.r(t),n.d(t,{default:function(){return k}});var i=n(1413),a=n(4165),r=n(5861),l=n(9439),s=n(2791),c=n(7022),o=n(9743),d=n(2677),u=n(6157),h=n(3675),x=n(6278),f=n(1648),p=n(9062),Z=n(2892),m=n(4453),g=n(7391),j=n(6362),v=n(9891),b=n(4925),y=n(8588),C=n(1747),S=n(9230),w=n(184);var N=function(){var e=(0,s.useState)(localStorage.getItem("isAuth")),t=(0,s.useState)(""),n=(0,l.Z)(t,2),N=n[0],k=n[1],I=(0,s.useState)(""),P=(0,l.Z)(I,2),T=P[0],L=P[1],R=(0,s.useState)(""),B=(0,l.Z)(R,2),F=B[0],M=B[1],V=(0,s.useState)(""),D=(0,l.Z)(V,2),U=D[0],W=D[1],O=(0,s.useState)(""),E=(0,l.Z)(O,2),H=E[0],z=E[1],A=(0,s.useState)(""),$=(0,l.Z)(A,2),_=$[0],q=$[1],G=(0,s.useState)(""),J=(0,l.Z)(G,2),Q=J[0],Y=J[1],K=(0,s.useState)(!1),X=(0,l.Z)(K,2),ee=X[0],te=X[1],ne=(0,s.useState)([]),ie=(0,l.Z)(ne,2),ae=ie[0],re=ie[1],le=(0,s.useState)(0),se=(0,l.Z)(le,2),ce=(se[0],se[1]),oe=(0,s.useState)({title:!1,price:!1,brand:!1,sale:!1,condition:!1,blade:!1,picture:!1}),de=(0,l.Z)(oe,2),ue=de[0],he=de[1],xe=(0,S.$G)().t,fe=(0,s.useMemo)((function(){var e=!Object.values(ue).some((function(e){return!1===e}));return!0===e&&te(!1),e}),[ue]),pe=function(){var e=(0,r.Z)((0,a.Z)().mark((function e(){var t,n,i;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(te(!0),fe){e.next=3;break}return e.abrupt("return");case 3:if(ae[0]){e.next=6;break}return alert("Please upload an image first!"),e.abrupt("return");case 6:return i=(0,p.hJ)(Z.db,"production-posts"),e.next=9,(0,p.ET)(i,{status:"Available",title:N,type:F,blade:Q,brand:U,condition:H,price:_,description:T,numberOfImages:ae.length,timeStamp:Date.now(),author:{name:(null===Z.I8||void 0===Z.I8||null===(t=Z.I8.currentUser)||void 0===t?void 0:t.displayName)||"anonymous",id:(null===Z.I8||void 0===Z.I8||null===(n=Z.I8.currentUser)||void 0===n?void 0:n.uid)||"none"}}).then((function(e){var t=[];return ae.map((function(n,i){var a=(0,m.iH)(Z.tO,"/".concat((0,h.NZ)(),"-postImages/").concat(e.id,"/image-").concat(i)),r=(0,m.B0)(a,n);t.push(r),r.on("state_changed",(function(e){var t=Math.round(e.bytesTransferred/e.totalBytes*100);ce(t)}),(function(e){return console.log(e)}),(function(){console.log(a)}))})),Promise.all(t).then((function(){console.log("all uploaded"),k(""),L(""),M(""),W(""),z(""),q(""),Y(""),re([]),te(!1)})).catch((function(e){console.error(e)})),e})).then((function(e){(0,x.iy)(e.id)})).catch((function(){console.log("error with creating post")}));case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ze=function(e,t){return e.map((function(e){return(0,w.jsx)(v.Z,{value:e,children:xe(e)},t+"-"+e)}))},me=(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(c.Z,{className:"create-header-container",children:(0,w.jsx)(o.Z,{children:(0,w.jsx)(d.Z,{className:"create-header",children:(0,w.jsx)("h2",{children:xe("Create Post")})})})}),(0,w.jsxs)(c.Z,{className:"create-container",children:[(0,w.jsxs)(o.Z,{children:[(0,w.jsx)(d.Z,{xs:12,md:6,className:"create-input",children:(0,w.jsx)(g.Z,{fullWidth:!0,label:xe("Title"),color:"",error:!1===ue.title&&ee,type:"search",value:N,onChange:function(e){var t=e.target.value;t.length>25||t.match(/['\-"><;:\\+{}!@#$%=^*_|[\]]/)||(he((function(e){return(0,i.Z)((0,i.Z)({},e),{},{title:""!==t})})),k(t))}})}),(0,w.jsx)(d.Z,{xs:12,md:6,className:"create-input",children:(0,w.jsx)(g.Z,{fullWidth:!0,label:xe("Price"),color:"",error:!1===ue.price&&ee,type:"number",value:_,onChange:function(e){var t=e.target.value;t.match(/[-]/)||(he((function(e){return(0,i.Z)((0,i.Z)({},e),{},{price:""!==t})})),q(t))}})}),(0,w.jsx)(d.Z,{xs:12,md:6,className:"create-input",children:(0,w.jsxs)(j.Z,{fullWidth:!0,error:!1===ue.brand&&ee,children:[(0,w.jsx)(b.Z,{id:"brand-label",children:xe("Brand")}),(0,w.jsx)(y.Z,{labelId:"brand-label",id:"brand-select",label:"Brand",defaultValue:"",value:U,onChange:function(e){var t=e.target.value;""!==t&&he((function(e){return(0,i.Z)((0,i.Z)({},e),{},{brand:!0})})),W(t)},children:Ze(h.YS,"brand")})]})}),(0,w.jsx)(d.Z,{xs:12,md:6,className:"create-input",children:(0,w.jsxs)(j.Z,{fullWidth:!0,error:!1===ue.sale&&ee,children:[(0,w.jsx)(b.Z,{id:"sale-type-label",children:xe("Sale Type")}),(0,w.jsx)(y.Z,{labelId:"sale-type-label",id:"sale-type-select",label:xe("Sale Type"),defaultValue:"",value:F,onChange:function(e){var t=e.target.value;""!==t&&he((function(e){return(0,i.Z)((0,i.Z)({},e),{},{sale:!0})})),M(t)},children:Ze(h.V5,"type")})]})}),(0,w.jsx)(d.Z,{xs:12,md:6,className:"create-input",children:(0,w.jsxs)(j.Z,{fullWidth:!0,error:!1===ue.condition&&ee,children:[(0,w.jsx)(b.Z,{id:"condition-label",children:xe("Condition")}),(0,w.jsx)(y.Z,{labelId:"condition-label",id:"condition-select",label:xe("Condition"),defaultValue:"",value:H,onChange:function(e){var t=e.target.value;""!==t&&he((function(e){return(0,i.Z)((0,i.Z)({},e),{},{condition:!0})})),z(t)},children:Ze([1,2,3,4,5,6,7,8,9,10],"condition")})]})}),(0,w.jsx)(d.Z,{xs:12,md:6,className:"create-input",children:(0,w.jsxs)(j.Z,{fullWidth:!0,error:!1===ue.blade&&ee,children:[(0,w.jsx)(b.Z,{id:"blade-label",children:xe("Blade")}),(0,w.jsx)(y.Z,{labelId:"blade-label",id:"blade-select",label:xe("Blade"),defaultValue:"",value:Q,onChange:function(e){var t=e.target.value;""!==t&&he((function(e){return(0,i.Z)((0,i.Z)({},e),{},{blade:!0})})),Y(t)},children:Ze(h.SP,"blade")})]})})]}),(0,w.jsx)(o.Z,{children:(0,w.jsx)(d.Z,{xs:12,children:(0,w.jsx)(C.Z,{style:{width:"100%"},minRows:5,value:T,placeholder:xe("Description"),label:xe("Description"),onChange:function(e){var t=e.target.value;t.length>425||t.match(/[\-><;:\\+{}@%=^*_|[\]]/)||L(t)}})})}),(0,w.jsx)(o.Z,{children:(0,w.jsx)(f.C,{files:ae,setFiles:re,validation:ue,setValidation:he,disableSubmit:ee})}),(0,w.jsx)(o.Z,{children:(0,w.jsx)(d.Z,{xs:12,className:"center",children:(0,w.jsx)(u.Z,{disabled:ee,className:"create-submit-button",onClick:pe,children:xe("Submit")})})})]})]}),ge=(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(c.Z,{className:"create-header-container",children:(0,w.jsx)(o.Z,{children:(0,w.jsx)(d.Z,{className:"create-header",children:(0,w.jsx)("h2",{children:xe("Information Missing")})})})}),(0,w.jsx)(c.Z,{className:"create-container",children:(0,w.jsx)(o.Z,{children:(0,w.jsx)(d.Z,{xs:12,children:(0,w.jsx)("h3",{children:"Please login before trying to create a post."})})})})]});return"true"===e[0]?me:ge},k=N}}]);
//# sourceMappingURL=753.c5f6ef83.chunk.js.map