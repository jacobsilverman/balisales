"use strict";(self.webpackChunkbalisales=self.webpackChunkbalisales||[]).push([[502],{6502:function(e,n,t){t.r(n),t.d(n,{default:function(){return D}});var i=t(4165),l=t(5861),r=t(1413),a=t(3433),s=t(9439),o=t(2791),d=t(3675),c=t(6519),u=t(9743),v=t(2677),f=t(6157),p=t(9230),h=t(184),Z=function(e){var n=e.deletePost,t=e.item,i=e.openDeleteModal,l=e.setOpenDeleteModal,r=e.setOpenEditModal,a=(0,p.$G)().t;return(0,h.jsx)(c.Z,{open:i,id:"delete-modal",children:(0,h.jsx)(u.Z,{className:"modal-dialog delete-modal",children:(0,h.jsxs)(v.Z,{xs:2,className:"modal-content modal-background-edit center",children:[(0,h.jsx)(u.Z,{className:"modal-header",children:(0,h.jsx)(v.Z,{className:"modal-title",children:a("Do you want to delete this post?")})}),(0,h.jsx)("br",{}),(0,h.jsxs)(u.Z,{children:[(0,h.jsx)(v.Z,{xs:6,children:(0,h.jsx)(f.Z,{onClick:function(){return l(!1)},children:a("No")})}),(0,h.jsx)(v.Z,{xs:6,children:(0,h.jsx)(f.Z,{onClick:function(){n(t).then((function(){return r(!1)})),l(!1)},children:a("Yes")})})]})]})})})},x=t(4674),m=t(9891),b=t(1747),j=t(7391),g=t(6362),y=t(4925),k=t(8588),w=t(9062),C=t(2892),S=t(6278),N=t(4453),P=function(){var e=(0,l.Z)((0,i.Z)().mark((function e(n,t){var l;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l=(0,w.JU)(C.db,"".concat((0,d.NZ)(),"-posts"),t),e.next=3,(0,w.pl)(l,n).then((function(){console.log("POST EDIT SAVED")})).catch((function(e){console.error("problem: ",e)}));case 3:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),z=function(e){var n=e.item,t=e.setPosts,z=e.openEditModal,D=e.setOpenEditModal,E=e.filterPosts,I=e.setFilterPosts,M=(0,o.useState)(null===n||void 0===n?void 0:n.title),O=(0,s.Z)(M,2),F=O[0],V=O[1],T=(0,o.useState)(null===n||void 0===n?void 0:n.description),q=(0,s.Z)(T,2),R=q[0],W=q[1],H=(0,o.useState)(null===n||void 0===n?void 0:n.type),B=(0,s.Z)(H,2),$=B[0],G=B[1],U=(0,o.useState)(null===n||void 0===n?void 0:n.blade),L=(0,s.Z)(U,2),X=L[0],A=L[1],J=(0,o.useState)(null===n||void 0===n?void 0:n.brand),Y=(0,s.Z)(J,2),_=Y[0],K=Y[1],Q=(0,o.useState)(null===n||void 0===n?void 0:n.condition),ee=(0,s.Z)(Q,2),ne=ee[0],te=ee[1],ie=(0,o.useState)(null===n||void 0===n?void 0:n.price),le=(0,s.Z)(ie,2),re=le[0],ae=le[1],se=(0,o.useState)(null===n||void 0===n?void 0:n.status),oe=(0,s.Z)(se,2),de=oe[0],ce=oe[1],ue=(0,o.useState)(!1),ve=(0,s.Z)(ue,2),fe=ve[0],pe=ve[1],he=(0,o.useState)(!1),Ze=(0,s.Z)(he,2),xe=Ze[0],me=Ze[1],be=(0,o.useState)(null===n||void 0===n?void 0:n.urls),je=(0,s.Z)(be,2),ge=je[0],ye=je[1],ke=(0,o.useState)({title:!0,type:!0,blade:!0,brand:!0,condition:!0,price:!0,picture:!0,status:!0}),we=(0,s.Z)(ke,2),Ce=we[0],Se=we[1],Ne=(0,p.$G)().t;(0,o.useEffect)((function(){var e=!1;return e||(V(null===n||void 0===n?void 0:n.title),W(null===n||void 0===n?void 0:n.description),G(null===n||void 0===n?void 0:n.type),A(null===n||void 0===n?void 0:n.blade),K(null===n||void 0===n?void 0:n.brand),te(null===n||void 0===n?void 0:n.condition),ae(null===n||void 0===n?void 0:n.price),ce(null===n||void 0===n?void 0:n.status),ye(null===n||void 0===n?void 0:n.urls)),function(){return e=!0}}),[n]);var Pe=(0,o.useMemo)((function(){var e=!Object.values(Ce).some((function(e){return!1===e}));return!0===e&&me(!1),e}),[Ce]),ze=function(e,n){return e.map((function(e){return(0,h.jsx)(m.Z,{value:e,children:Ne(e)},n+"-"+e)}))},De=function(){var e=(0,l.Z)((0,i.Z)().mark((function e(n){var t,l,r,a;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,N.cF)(),l=(0,w.JU)(C.db,"".concat((0,d.NZ)(),"-posts"),n.id),e.next=4,(0,w.oe)(l);case 4:(0,S.sq)(n.id),r=0;case 6:if(!(r<n.numberOfImages)){e.next=13;break}return a=(0,N.iH)(t,"".concat((0,d.NZ)(),"-postImages/").concat(n.id,"/image-").concat(r)),e.next=10,(0,N.oq)(a);case 10:r++,e.next=6;break;case 13:I(null===E||void 0===E?void 0:E.filter((function(e){return e.id!==n.id})));case 14:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),Ee=function(){var e=(0,l.Z)((0,i.Z)().mark((function e(){var t,r,a,s,o,c;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=(0,N.cF)(),r=(0,N.iH)(t,"".concat((0,d.NZ)(),"-postImages/").concat(n.id)),a={},e.next=6,Promise.all(ge.map(function(){var e=(0,l.Z)((0,i.Z)().mark((function e(n,t){var l;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("string"===typeof n){e.next=4;break}a[t]=n,e.next=9;break;case 4:return(l=new XMLHttpRequest).responseType="blob",e.next=8,new Promise((function(e,t){l.onload=function(n){var i=l.response;i?e(i):t(new Error("Failed to fetch blob"))},l.onerror=function(e){t(new Error("XHR request failed"))},l.open("GET",n),l.send()}));case 8:a[t]=e.sent;case 9:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}()));case 6:return e.next=8,(0,N.aF)(r);case 8:return s=e.sent,e.next=11,Promise.all(s.items.map(function(){var e=(0,l.Z)((0,i.Z)().mark((function e(n){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,N.oq)(n);case 3:console.log("Deleted ".concat(n.fullPath)),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.error("Error deleting ".concat(n.fullPath,": ").concat(e.t0.message));case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(n){return e.apply(this,arguments)}}()));case 11:return o=Object.keys(a).map(function(){var e=(0,l.Z)((0,i.Z)().mark((function e(l){var r;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(0,N.iH)(t,"".concat((0,d.NZ)(),"-postImages/").concat(n.id,"/image-").concat(l)),e.abrupt("return",(0,N.B0)(r,a[l]));case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()),e.next=14,Promise.all(o);case 14:c=e.sent,console.log("blobMap uploaded: ",c),window.location.reload(),e.next=22;break;case 19:e.prev=19,e.t0=e.catch(0),console.error(e.t0);case 22:case"end":return e.stop()}}),e,null,[[0,19]])})));return function(){return e.apply(this,arguments)}}();return(0,h.jsx)(c.Z,{open:z,onClick:function(){return D(!1)},children:(0,h.jsx)(u.Z,{className:"edit-modal",children:(0,h.jsxs)(v.Z,{xs:7,className:"modal-background-edit center",onClick:function(e){return e.stopPropagation()},children:[(0,h.jsx)(f.Z,{variant:"outlined",id:"select-modal-exit-button",color:"error",onClick:function(e){D(!1),V(null===n||void 0===n?void 0:n.title),W(null===n||void 0===n?void 0:n.description),G(null===n||void 0===n?void 0:n.type),A(null===n||void 0===n?void 0:n.blade),K(null===n||void 0===n?void 0:n.brand),te(null===n||void 0===n?void 0:n.condition),ae(null===n||void 0===n?void 0:n.price),ce(null===n||void 0===n?void 0:n.status),ye(null===n||void 0===n?void 0:n.urls)},children:"X"}),(0,h.jsx)(Z,{deletePost:De,item:n,openDeleteModal:fe,setOpenDeleteModal:pe,setOpenEditModal:D}),(0,h.jsxs)(u.Z,{className:"edit-input",children:[(0,h.jsx)(v.Z,{xs:4,className:"left",children:(0,h.jsx)("h2",{children:Ne("Edit")})}),(0,h.jsx)(v.Z,{children:(0,h.jsx)(j.Z,{error:!Ce.title,fullWidth:!0,size:"small",value:F,label:Ne("Title"),className:"input-width",onChange:function(e){var n=e.target.value;n.match(/['\-"><;:\\+{}!@#$%=^*_|[\]]/)||(Se((function(e){return(0,r.Z)((0,r.Z)({},e),{},{title:""!==n})})),V(n))}})})]}),(0,h.jsxs)(u.Z,{className:"edit-input",children:[(0,h.jsx)(v.Z,{sm:4,children:(0,h.jsxs)(g.Z,{fullWidth:!0,children:[(0,h.jsx)(y.Z,{error:!1===Ce.status&&xe,size:"small",id:"status-edit-label",children:Ne("Status")}),(0,h.jsx)(k.Z,{labelId:"status-edit-label",id:"status-edit-select",size:"small",defaultValue:null===n||void 0===n?void 0:n.status,value:de,label:Ne("Status"),onChange:function(e){var n=e.target.value;""!==n&&Se((function(e){return(0,r.Z)((0,r.Z)({},e),{},{status:!0})})),ce(n)},children:ze(d.Do,"status")})]})}),(0,h.jsx)(v.Z,{sm:4,children:(0,h.jsxs)(g.Z,{fullWidth:!0,children:[(0,h.jsx)(y.Z,{error:!1===Ce.type&&xe,size:"small",id:"business-edit-label",children:Ne("Sale Type")}),(0,h.jsx)(k.Z,{labelId:"business-edit-label",id:"business-edit-select",size:"small",defaultValue:null===n||void 0===n?void 0:n.type,value:$,label:Ne("Sale Type"),onChange:function(e){var n=e.target.value;""!==n&&Se((function(e){return(0,r.Z)((0,r.Z)({},e),{},{type:!0})})),G(n)},children:ze(d.V5,"type")})]})}),(0,h.jsx)(v.Z,{sm:4,children:(0,h.jsx)(j.Z,{fullWidth:!0,size:"small",value:re,type:"number",label:Ne("Price"),onChange:function(e){var n=e.target.value;n.match(/['\-"]/)||(Se((function(e){return(0,r.Z)((0,r.Z)({},e),{},{price:""!==n})})),ae(n))}})})]}),(0,h.jsxs)(u.Z,{className:"edit-input",children:[(0,h.jsx)(v.Z,{sm:4,children:(0,h.jsxs)(g.Z,{fullWidth:!0,children:[(0,h.jsx)(y.Z,{error:!1===Ce.brand&&xe,size:"small",id:"brand-edit-label",children:Ne("Brand")}),(0,h.jsx)(k.Z,{labelId:"brand-edit-label",id:"brand-edit-select",size:"small",defaultValue:null===n||void 0===n?void 0:n.brand,value:_,label:Ne("Brand"),onChange:function(e){var n=e.target.value;""!==n&&Se((function(e){return(0,r.Z)((0,r.Z)({},e),{},{brand:!0})})),K(n)},children:ze(d.YS,"brand")})]})}),(0,h.jsx)(v.Z,{sm:4,children:(0,h.jsxs)(g.Z,{fullWidth:!0,error:!1===Ce.blade&&xe,children:[(0,h.jsx)(y.Z,{id:"blade-edit-label",size:"small",children:Ne("Blade")}),(0,h.jsx)(k.Z,{labelId:"blade-edit-label",id:"blade-edit-select",size:"small",defaultValue:null===n||void 0===n?void 0:n.blade,value:X,label:Ne("Blade"),onChange:function(e){var n=e.target.value;""!==n&&Se((function(e){return(0,r.Z)((0,r.Z)({},e),{},{blade:!0})})),A(n)},children:ze(d.SP,"blade")})]})}),(0,h.jsx)(v.Z,{sm:4,children:(0,h.jsxs)(g.Z,{fullWidth:!0,children:[(0,h.jsx)(y.Z,{error:!1===Ce.condition&&xe,size:"small",id:"condition-edit-label",children:Ne("Condition")}),(0,h.jsx)(k.Z,{labelId:"condition-edit-label",id:"condition-edit-select",size:"small",defaultValue:null===n||void 0===n?void 0:n.condition,value:ne,label:Ne("Condition"),onChange:function(e){var n=e.target.value;""!==n&&Se((function(e){return(0,r.Z)((0,r.Z)({},e),{},{condition:!0})})),te(n)},children:ze([1,2,3,4,5,6,7,8,9,10],"condition")})]})})]}),(0,h.jsx)(u.Z,{className:"edit-input",children:(0,h.jsx)(v.Z,{xs:12,children:(0,h.jsx)(b.Z,{style:{width:"100%"},minRows:3,value:R,placeholder:Ne("Description"),label:Ne("Description"),onChange:function(e){var n=e.target.value;n.match(/['\-"><;:\\+{}!@#$%=^*_|[\]]/)||W(n)}})})}),(0,h.jsx)(x.C,{files:ge,setFiles:ye,validation:Ce,setValidation:Se,disableSubmit:xe}),(0,h.jsxs)(u.Z,{className:"edit-input",children:[(0,h.jsx)(v.Z,{xs:6,children:(0,h.jsx)(f.Z,{variant:"danger",onClick:function(e){e.preventDefault(),pe(!0)},children:Ne("Delete")})}),(0,h.jsx)(v.Z,{xs:6,children:(0,h.jsx)(f.Z,{disabled:xe,onClick:function(){Pe?(Pe&&P({title:F,type:$,blade:X,brand:_,condition:ne,price:re,description:R,status:de,timeStamp:n.timeStamp,editTimeStamp:Date.now(),numberOfImages:ge.length,author:{name:n.author.name,id:n.author.id}},n.id).then((function(e){t((function(e){return(0,a.Z)(e.map((function(e){return e.id===n.id?(0,r.Z)((0,r.Z)({},n),{},{title:F,type:$,blade:X,brand:_,condition:ne,price:re,description:R,status:de}):e})))})),console.log("result: ",e)})).catch((function(e){console.error("problem when saving the edit post: ",e)})),Ee(),D(!1)):me(!0)},children:Ne("Submit")})})]})]})})})},D=z},4674:function(e,n,t){t.d(n,{C:function(){return p}});var i=t(1413),l=t(3433),r=t(9135),a=t(3675),s=t(9743),o=t(2677),d=t(6157),c=t(1889),u=t(7621),v=t(9230),f=t(184),p=function(e){var n=e.files,t=e.setFiles,p=e.validation,h=e.setValidation,Z=e.disableSubmit,x=(null===n||void 0===n?void 0:n.length)<=1?"200px":"100px",m=(0,v.$G)().t,b=(0,f.jsx)(s.Z,{className:"edit-input",children:(0,f.jsx)(o.Z,{xs:12,className:"setting-item",children:(0,f.jsxs)("label",{className:"profile-label center",style:{color:!1===p.picture&&Z?"red":"black"},htmlFor:"add-post-image",children:[(0,f.jsx)("input",{id:"add-post-image",className:"profile-input",type:"file",onChange:function(e){h((function(e){return(0,i.Z)((0,i.Z)({},e),{},{picture:!0})})),t((function(n){return[].concat((0,l.Z)(n),[e.target.files[0]])}))},accept:"image/*"}),(0,f.jsx)("span",{children:m("Add Picture")}),(0,f.jsx)("br",{}),(0,f.jsx)(r.H3h,{size:40})]})})}),j=(0,f.jsx)(c.ZP,{justifyContent:"center",container:!0,spacing:3,children:null===n||void 0===n?void 0:n.map((function(e,r){var s="string"!==typeof e?URL.createObjectURL(e):e,o=0===r?"flex-end":r!==n.length-1?"space-between":"flex-start";return(0,f.jsx)(c.ZP,{item:!0,children:(0,f.jsxs)(u.Z,{children:[(0,f.jsx)(d.Z,{variant:"danger",style:{width:"100%",borderRadius:"0px"},onClick:function(){return function(e){var l=null===n||void 0===n?void 0:n.filter((function(n,t){return t!==e}));0===l.length&&h((function(e){return(0,i.Z)((0,i.Z)({},e),{},{picture:!1})})),t(l)}(r)},children:m("Remove")}),(0,f.jsx)(c.ZP,{item:!0,className:"center",style:{backgroundImage:"url(".concat(s,")"),backgroundSize:"100% 100%",width:x,height:x}},s),(0,f.jsxs)("div",{style:{display:"flex",justifyContent:o},children:[r>0&&(0,f.jsx)(d.Z,{variant:"outlined",onClick:function(){return function(e){e<=0||t((function(n){var t=(0,l.Z)(n),i=t[e-1];return t[e-1]=t[e],t[e]=i,t}))}(r)},children:a.tq?"^":"<"}),r<n.length-1&&(0,f.jsx)(d.Z,{variant:"outlined",onClick:function(){return function(e){e>=(null===n||void 0===n?void 0:n.length)-1||t((function(n){var t=(0,l.Z)(n),i=t[e+1];return t[e+1]=t[e],t[e]=i,t}))}(r)},children:a.tq?"v":">"})]})]})},s)}))});return(0,f.jsxs)(f.Fragment,{children:[b,j]})}}}]);
//# sourceMappingURL=502.bf445960.chunk.js.map