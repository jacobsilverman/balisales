"use strict";(self.webpackChunkbalisales=self.webpackChunkbalisales||[]).push([[242],{6502:function(e,t,n){n.r(t),n.d(t,{default:function(){return z}});var i=n(4165),l=n(5861),a=n(1413),r=n(3433),s=n(9439),o=n(2791),d=n(3675),c=n(6519),u=n(9743),h=n(2677),v=n(6157),p=n(9230),f=n(184),x=function(e){var t=e.deletePost,n=e.item,i=e.openDeleteModal,l=e.setOpenDeleteModal,a=e.setOpenEditModal,r=(0,p.$G)().t;return(0,f.jsx)(c.Z,{open:i,id:"delete-modal",children:(0,f.jsx)(u.Z,{className:"modal-dialog delete-modal",children:(0,f.jsxs)(h.Z,{xs:2,className:"modal-content modal-background-edit center",children:[(0,f.jsx)(u.Z,{className:"modal-header",children:(0,f.jsx)(h.Z,{className:"modal-title",children:r("Do you want to delete this post?")})}),(0,f.jsx)("br",{}),(0,f.jsxs)(u.Z,{children:[(0,f.jsx)(h.Z,{xs:6,children:(0,f.jsx)(v.Z,{onClick:function(){return l(!1)},children:r("No")})}),(0,f.jsx)(h.Z,{xs:6,children:(0,f.jsx)(v.Z,{onClick:function(){t(n).then((function(){return a(!1)})),l(!1)},children:r("Yes")})})]})]})})})},Z=n(1648),m=n(9891),b=n(1747),j=n(7391),g=n(6362),w=n(4925),y=n(8588),C=n(9062),k=n(2892),S=n(6278),N=n(4453),P=function(){var e=(0,l.Z)((0,i.Z)().mark((function e(t,n){var l;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l=(0,C.JU)(k.db,"".concat((0,d.NZ)(),"-posts"),n),e.next=3,(0,C.pl)(l,t).then((function(){console.log("POST EDIT SAVED")})).catch((function(e){console.error("problem: ",e)}));case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),D=function(e){var t=e.item,n=e.setPosts,D=e.openEditModal,z=e.setOpenEditModal,I=e.filterPosts,M=e.setFilterPosts,E=(0,o.useState)(null===t||void 0===t?void 0:t.title),T=(0,s.Z)(E,2),F=T[0],O=T[1],L=(0,o.useState)(null===t||void 0===t?void 0:t.description),R=(0,s.Z)(L,2),V=R[0],H=R[1],W=(0,o.useState)(null===t||void 0===t?void 0:t.type),q=(0,s.Z)(W,2),B=q[0],U=q[1],$=(0,o.useState)(null===t||void 0===t?void 0:t.blade),G=(0,s.Z)($,2),X=G[0],A=G[1],J=(0,o.useState)(null===t||void 0===t?void 0:t.brand),Y=(0,s.Z)(J,2),_=Y[0],Q=Y[1],K=(0,o.useState)(null===t||void 0===t?void 0:t.condition),ee=(0,s.Z)(K,2),te=ee[0],ne=ee[1],ie=(0,o.useState)(null===t||void 0===t?void 0:t.price),le=(0,s.Z)(ie,2),ae=le[0],re=le[1],se=(0,o.useState)(null===t||void 0===t?void 0:t.status),oe=(0,s.Z)(se,2),de=oe[0],ce=oe[1],ue=(0,o.useState)(!1),he=(0,s.Z)(ue,2),ve=he[0],pe=he[1],fe=(0,o.useState)(!1),xe=(0,s.Z)(fe,2),Ze=xe[0],me=xe[1],be=(0,o.useState)(null===t||void 0===t?void 0:t.urls),je=(0,s.Z)(be,2),ge=je[0],we=je[1],ye=(0,o.useState)({title:!0,type:!0,blade:!0,brand:!0,condition:!0,price:!0,picture:!0,status:!0}),Ce=(0,s.Z)(ye,2),ke=Ce[0],Se=Ce[1],Ne=(0,p.$G)().t;(0,o.useEffect)((function(){var e=!1;return e||(O(null===t||void 0===t?void 0:t.title),H(null===t||void 0===t?void 0:t.description),U(null===t||void 0===t?void 0:t.type),A(null===t||void 0===t?void 0:t.blade),Q(null===t||void 0===t?void 0:t.brand),ne(null===t||void 0===t?void 0:t.condition),re(null===t||void 0===t?void 0:t.price),ce(null===t||void 0===t?void 0:t.status),we(null===t||void 0===t?void 0:t.urls)),function(){return e=!0}}),[t]);var Pe=(0,o.useMemo)((function(){var e=!Object.values(ke).some((function(e){return!1===e}));return!0===e&&me(!1),e}),[ke]),De=function(e,t){return e.map((function(e){return(0,f.jsx)(m.Z,{value:e,children:Ne(e)},t+"-"+e)}))},ze=function(){var e=(0,l.Z)((0,i.Z)().mark((function e(t){var n,l,a,r;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,N.cF)(),l=(0,C.JU)(k.db,"".concat((0,d.NZ)(),"-posts"),t.id),e.next=4,(0,C.oe)(l);case 4:(0,S.sq)(t.id),a=0;case 6:if(!(a<t.numberOfImages)){e.next=13;break}return r=(0,N.iH)(n,"".concat((0,d.NZ)(),"-postImages/").concat(t.id,"/image-").concat(a)),e.next=10,(0,N.oq)(r);case 10:a++,e.next=6;break;case 13:M(null===I||void 0===I?void 0:I.filter((function(e){return e.id!==t.id})));case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ie=function(){var e=(0,l.Z)((0,i.Z)().mark((function e(){var n,a,r,s,o,c;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=(0,N.cF)(),a=(0,N.iH)(n,"".concat((0,d.NZ)(),"-postImages/").concat(t.id)),r={},e.next=6,Promise.all(ge.map(function(){var e=(0,l.Z)((0,i.Z)().mark((function e(t,n){var l;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("string"===typeof t){e.next=4;break}r[n]=t,e.next=9;break;case 4:return(l=new XMLHttpRequest).responseType="blob",e.next=8,new Promise((function(e,n){l.onload=function(t){var i=l.response;i?e(i):n(new Error("Failed to fetch blob"))},l.onerror=function(e){n(new Error("XHR request failed"))},l.open("GET",t),l.send()}));case 8:r[n]=e.sent;case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 6:return e.next=8,(0,N.aF)(a);case 8:return s=e.sent,e.next=11,Promise.all(s.items.map(function(){var e=(0,l.Z)((0,i.Z)().mark((function e(t){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,N.oq)(t);case 3:console.log("Deleted ".concat(t.fullPath)),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.error("Error deleting ".concat(t.fullPath,": ").concat(e.t0.message));case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}()));case 11:return o=Object.keys(r).map(function(){var e=(0,l.Z)((0,i.Z)().mark((function e(l){var a;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=(0,N.iH)(n,"".concat((0,d.NZ)(),"-postImages/").concat(t.id,"/image-").concat(l)),e.abrupt("return",(0,N.B0)(a,r[l]));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=14,Promise.all(o);case 14:c=e.sent,console.log("blobMap uploaded: ",c),window.location.reload(),e.next=22;break;case 19:e.prev=19,e.t0=e.catch(0),console.error(e.t0);case 22:case"end":return e.stop()}}),e,null,[[0,19]])})));return function(){return e.apply(this,arguments)}}(),Me=(0,o.useState)({display:"block"}),Ee=(0,s.Z)(Me,2),Te=Ee[0],Fe=Ee[1];return(0,f.jsx)(c.Z,{style:Te,open:D,onClick:function(){return z(!1)},children:(0,f.jsx)(u.Z,{className:"edit-modal",children:(0,f.jsxs)(h.Z,{xs:7,className:"modal-background-edit center",onClick:function(e){return e.stopPropagation()},children:[(0,f.jsx)(v.Z,{variant:"outlined",id:"select-modal-exit-button",color:"error",onClick:function(e){z(!1),O(null===t||void 0===t?void 0:t.title),H(null===t||void 0===t?void 0:t.description),U(null===t||void 0===t?void 0:t.type),A(null===t||void 0===t?void 0:t.blade),Q(null===t||void 0===t?void 0:t.brand),ne(null===t||void 0===t?void 0:t.condition),re(null===t||void 0===t?void 0:t.price),ce(null===t||void 0===t?void 0:t.status),we(null===t||void 0===t?void 0:t.urls)},children:"X"}),(0,f.jsx)(x,{deletePost:ze,item:t,openDeleteModal:ve,setOpenDeleteModal:pe,setOpenEditModal:z}),(0,f.jsxs)(u.Z,{className:"edit-input",children:[(0,f.jsx)(h.Z,{xs:4,className:"left",children:(0,f.jsx)("h2",{children:Ne("Edit")})}),(0,f.jsx)(h.Z,{children:(0,f.jsx)(j.Z,{error:!ke.title,fullWidth:!0,size:"small",value:F,label:Ne("Title"),className:"input-width",onChange:function(e){var t=e.target.value;t.match(/['\-"><;:\\+{}!@#$%=^*_|[\]]/)||(Se((function(e){return(0,a.Z)((0,a.Z)({},e),{},{title:""!==t})})),O(t))}})})]}),(0,f.jsxs)(u.Z,{className:"edit-input",children:[(0,f.jsx)(h.Z,{sm:4,children:(0,f.jsxs)(g.Z,{fullWidth:!0,children:[(0,f.jsx)(w.Z,{error:!1===ke.status&&Ze,size:"small",id:"status-edit-label",children:Ne("Status")}),(0,f.jsx)(y.Z,{labelId:"status-edit-label",id:"status-edit-select",size:"small",defaultValue:null===t||void 0===t?void 0:t.status,value:de,label:Ne("Status"),onChange:function(e){var t=e.target.value;""!==t&&Se((function(e){return(0,a.Z)((0,a.Z)({},e),{},{status:!0})})),ce(t)},children:De(d.Do,"status")})]})}),(0,f.jsx)(h.Z,{sm:4,children:(0,f.jsxs)(g.Z,{fullWidth:!0,children:[(0,f.jsx)(w.Z,{error:!1===ke.type&&Ze,size:"small",id:"business-edit-label",children:Ne("Sale Type")}),(0,f.jsx)(y.Z,{labelId:"business-edit-label",id:"business-edit-select",size:"small",defaultValue:null===t||void 0===t?void 0:t.type,value:B,label:Ne("Sale Type"),onChange:function(e){var t=e.target.value;""!==t&&Se((function(e){return(0,a.Z)((0,a.Z)({},e),{},{type:!0})})),U(t)},children:De(d.V5,"type")})]})}),(0,f.jsx)(h.Z,{sm:4,children:(0,f.jsx)(j.Z,{fullWidth:!0,size:"small",value:ae,type:"number",label:Ne("Price"),onChange:function(e){var t=e.target.value;t.match(/['\-"]/)||(Se((function(e){return(0,a.Z)((0,a.Z)({},e),{},{price:""!==t})})),re(t))}})})]}),(0,f.jsxs)(u.Z,{className:"edit-input",children:[(0,f.jsx)(h.Z,{sm:4,children:(0,f.jsxs)(g.Z,{fullWidth:!0,children:[(0,f.jsx)(w.Z,{error:!1===ke.brand&&Ze,size:"small",id:"brand-edit-label",children:Ne("Brand")}),(0,f.jsx)(y.Z,{labelId:"brand-edit-label",id:"brand-edit-select",size:"small",defaultValue:null===t||void 0===t?void 0:t.brand,value:_,label:Ne("Brand"),onChange:function(e){var t=e.target.value;""!==t&&Se((function(e){return(0,a.Z)((0,a.Z)({},e),{},{brand:!0})})),Q(t)},children:De(d.YS,"brand")})]})}),(0,f.jsx)(h.Z,{sm:4,children:(0,f.jsxs)(g.Z,{fullWidth:!0,error:!1===ke.blade&&Ze,children:[(0,f.jsx)(w.Z,{id:"blade-edit-label",size:"small",children:Ne("Blade")}),(0,f.jsx)(y.Z,{labelId:"blade-edit-label",id:"blade-edit-select",size:"small",defaultValue:null===t||void 0===t?void 0:t.blade,value:X,label:Ne("Blade"),onChange:function(e){var t=e.target.value;""!==t&&Se((function(e){return(0,a.Z)((0,a.Z)({},e),{},{blade:!0})})),A(t)},children:De(d.SP,"blade")})]})}),(0,f.jsx)(h.Z,{sm:4,children:(0,f.jsxs)(g.Z,{fullWidth:!0,children:[(0,f.jsx)(w.Z,{error:!1===ke.condition&&Ze,size:"small",id:"condition-edit-label",children:Ne("Condition")}),(0,f.jsx)(y.Z,{labelId:"condition-edit-label",id:"condition-edit-select",size:"small",defaultValue:null===t||void 0===t?void 0:t.condition,value:te,label:Ne("Condition"),onChange:function(e){var t=e.target.value;""!==t&&Se((function(e){return(0,a.Z)((0,a.Z)({},e),{},{condition:!0})})),ne(t)},children:De([1,2,3,4,5,6,7,8,9,10],"condition")})]})})]}),(0,f.jsx)(u.Z,{className:"edit-input",children:(0,f.jsx)(h.Z,{xs:12,children:(0,f.jsx)(b.Z,{style:{width:"100%"},minRows:3,value:V,placeholder:Ne("Description"),label:Ne("Description"),onChange:function(e){var t=e.target.value;t.match(/['\-"><;:\\+{}!@#$%=^*_|[\]]/)||H(t)}})})}),(0,f.jsx)(Z.C,{files:ge,setFiles:we,validation:ke,setValidation:Se,disableSubmit:Ze,setDisplay:Fe}),(0,f.jsxs)(u.Z,{className:"edit-input",children:[(0,f.jsx)(h.Z,{xs:6,children:(0,f.jsx)(v.Z,{variant:"danger",onClick:function(e){e.preventDefault(),pe(!0)},children:Ne("Delete")})}),(0,f.jsx)(h.Z,{xs:6,children:(0,f.jsx)(v.Z,{disabled:Ze,onClick:function(){Pe?(Pe&&P({title:F,type:B,blade:X,brand:_,condition:te,price:ae,description:V,status:de,timeStamp:t.timeStamp,editTimeStamp:Date.now(),numberOfImages:ge.length,author:{name:t.author.name,id:t.author.id}},t.id).then((function(e){n((function(e){return(0,r.Z)(e.map((function(e){return e.id===t.id?(0,a.Z)((0,a.Z)({},t),{},{title:F,type:B,blade:X,brand:_,condition:te,price:ae,description:V,status:de}):e})))})),console.log("result: ",e)})).catch((function(e){console.error("problem when saving the edit post: ",e)})),Ie(),z(!1)):me(!0)},children:Ne("Submit")})})]})]})})})},z=D},1648:function(e,t,n){n.d(t,{C:function(){return j}});var i=n(1413),l=n(3433),a=n(9439),r=n(9135),s=n(3675),o=n(2791),d=n(9743),c=n(2677),u=n(6157),h=n(1889),v=n(7621),p=n(9230),f=n(6151),x=n(4727),Z=n(5419),m=(n(9390),n(184)),b=function(e){var t=e.imageLoaded,n=e.setImageLoaded,r=e.imageToCrop,s=e.showCropModal,d=e.setShowCropModal,c=e.setFiles,u=e.setValidation,h=e.setDisplay,v=(0,o.useState)(),p=(0,a.Z)(v,2),b=p[0],j=p[1],g=(0,o.useState)(null),w=(0,a.Z)(g,2),y=w[0],C=w[1],k=(0,o.useState)(null),S=(0,a.Z)(k,2),N=S[0],P=S[1],D=(0,o.useState)(null),z=(0,a.Z)(D,2),I=z[0],M=z[1],E=r?URL.createObjectURL(r):null,T=function(){d(!1),j(),C(),P(),h&&h({display:"block"})};return(0,m.jsxs)(x.Z,{show:s,onBackdropClick:function(){return T()},children:[(0,m.jsx)("div",{style:{display:"flex",justifyContent:"flex-end",padding:"5px"},children:(0,m.jsx)(f.Z,{onClick:T,color:"error",children:"close"})}),(0,m.jsx)("div",{children:"Please accommodate resizing images to fit the 250px 300px dimensions"}),r&&(0,m.jsx)(Z.ZP,{crop:b,onChange:function(e){return j(e)},children:(0,m.jsx)("img",{src:E,onLoad:function(e){if(C(e.currentTarget),r&&!t){var i=e.currentTarget,l=i.width,a=i.height,s=l-250,o=a-300,d=0,c=0;if(o<s){var u=(l-.83*a)/2;l=.83*a,d=u}else if(o>s){var h=(a-(l+.17*l))/2;a=l+.17*l,c=h}j({unit:"px",width:l,height:a,x:d,y:c}),n(!0)}}})}),(0,m.jsx)(f.Z,{variant:"outlined",onClick:function(){!function(){var e=document.createElement("canvas"),t=y.naturalWidth/y.width,n=y.naturalHeight/y.height;e.width=b.width,e.height=b.height;var i=e.getContext("2d"),l=window.devicePixelRatio;e.width=b.width*l,e.height=b.height*l,i.setTransform(l,0,0,l,0,0),i.imageSmoothingQuality="high",i.drawImage(y,b.x*t,b.y*n,b.width*t,b.height*n,0,0,b.width,b.height);var a=e.toDataURL("image/jpeg");P(a),e.toBlob((function(e){M(e)}))}()},children:"Preview"}),N&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)("div",{className:"center",children:[(0,m.jsx)("div",{children:"Here is a preview of how your image will display"}),(0,m.jsx)("img",{src:N,style:{height:"300px",width:"250px"}})]}),(0,m.jsx)(f.Z,{variant:"contained",color:"success",onClick:function(){T(),c((function(e){return[].concat((0,l.Z)(e),[I])})),u((function(e){return(0,i.Z)((0,i.Z)({},e),{},{picture:!0})}))},children:"Submit"})]})]})},j=function(e){var t=e.files,n=e.setFiles,f=e.validation,x=e.setValidation,Z=e.disableSubmit,j=e.setDisplay,g=(null===t||void 0===t?void 0:t.length)<=1?"200px":"100px",w=(0,p.$G)().t,y=(0,o.useState)(),C=(0,a.Z)(y,2),k=C[0],S=C[1],N=(0,o.useState)(!1),P=(0,a.Z)(N,2),D=P[0],z=P[1],I=(0,m.jsx)(d.Z,{className:"edit-input",children:(0,m.jsx)(c.Z,{xs:12,className:"setting-item",children:(0,m.jsxs)("label",{className:"profile-label center",style:{color:!1===f.picture&&Z?"red":"black"},htmlFor:"add-post-image",children:[(0,m.jsx)("input",{id:"add-post-image",className:"profile-input",type:"file",onChange:function(e){j&&j({display:"none"}),S(e.target.files[0]),z(!0),O(!1)},accept:"image/*"}),(0,m.jsx)("span",{children:w("Add Picture")}),(0,m.jsx)("br",{}),(0,m.jsx)(r.H3h,{size:40})]})})}),M=(0,m.jsx)(h.ZP,{justifyContent:"center",container:!0,spacing:3,children:null===t||void 0===t?void 0:t.map((function(e,a){var r="string"!==typeof e?URL.createObjectURL(e):e,o=0===a?"flex-end":a!==t.length-1?"space-between":"flex-start";return(0,m.jsx)(h.ZP,{item:!0,children:(0,m.jsxs)(v.Z,{children:[(0,m.jsx)(u.Z,{variant:"danger",style:{width:"100%",borderRadius:"0px"},onClick:function(){return function(e){var l=null===t||void 0===t?void 0:t.filter((function(t,n){return n!==e}));0===l.length&&x((function(e){return(0,i.Z)((0,i.Z)({},e),{},{picture:!1})})),n(l)}(a)},children:w("Remove")}),(0,m.jsx)(h.ZP,{item:!0,className:"center",style:{backgroundImage:"url(".concat(r,")"),backgroundSize:"100% 100%",width:g,height:g}},r+"item"),(0,m.jsxs)("div",{style:{display:"flex",justifyContent:o},children:[a>0&&(0,m.jsx)(u.Z,{variant:"outlined",onClick:function(){return function(e){e<=0||n((function(t){var n=(0,l.Z)(t),i=n[e-1];return n[e-1]=n[e],n[e]=i,n}))}(a)},children:s.tq?"^":"<"}),a<t.length-1&&(0,m.jsx)(u.Z,{variant:"outlined",onClick:function(){return function(e){e>=(null===t||void 0===t?void 0:t.length)-1||n((function(t){var n=(0,l.Z)(t),i=n[e+1];return n[e+1]=n[e],n[e]=i,n}))}(a)},children:s.tq?"v":">"})]})]})},r)}))}),E=(0,o.useState)(!1),T=(0,a.Z)(E,2),F=T[0],O=T[1];return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(b,{imageLoaded:F,setImageLoaded:O,imageToCrop:k,showCropModal:D,setShowCropModal:z,setValidation:x,setFiles:n,setDisplay:j}),I,M]})}}}]);
//# sourceMappingURL=242.04c12a06.chunk.js.map